"use strict";(self["webpackChunkhm_shopping"]=self["webpackChunkhm_shopping"]||[]).push([[204],{1204:function(t,e,i){i.r(e),i.d(e,{default:function(){return f}});i(4114);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"orders"},[e("header",[e("van-nav-bar",{attrs:{title:"我的订单","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}}),e("van-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[e("van-tab",{attrs:{name:"all",title:"全部"}}),e("van-tab",{attrs:{name:"payment",title:"待支付"}}),e("van-tab",{attrs:{name:"delivery",title:"待发货"}}),e("van-tab",{attrs:{name:"received",title:"待收货"}}),e("van-tab",{attrs:{name:"comment",title:"待评价"}})],1)],1),t.list.length>0?e("div",{staticClass:"content"},[t._l(t.list,(function(i){return e("OrderListItem",{key:i.order_id,attrs:{item:i},on:{"order-updated":t.getOrderList},nativeOn:{click:function(e){return t.$router.push(`/orderDetail?orderId=${i.order_id}`)}}})})),e("footer",[t._v(" 亲，没有更多了 ")])],2):e("div",{staticClass:"empty",staticStyle:{height:"calc(100vh - 90px)"}},[e("img",{attrs:{src:i(6661),alt:""}}),e("div",{staticClass:"tips"},[t._v(" 亲，暂无订单记录 ")])])])},r=[],s=(i(8992),i(3949),i(8872),function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list-item"},[e("div",{staticClass:"tit"},[e("div",{staticClass:"time"},[t._v(t._s(t.item.create_time))]),e("div",{staticClass:"status"},[e("span",[t._v(t._s(t.item.state_text))])])]),e("div",{staticClass:"list"},t._l(t.item.goods,(function(i){return e("div",{key:i.goods_id,staticClass:"list-item"},[e("div",{staticClass:"goods-img"},[e("img",{attrs:{src:i.goods_image,alt:""}})]),e("div",{staticClass:"goods-content text-ellipsis-2"},[t._v(" "+t._s(i.goods_name)+" ")]),e("div",{staticClass:"goods-trade"},[e("p",[t._v("¥ "+t._s(i.goods_price))]),e("p",[t._v("x "+t._s(i.total_num))])])])})),0),e("div",{staticClass:"total"},[t._v(" 共"+t._s(t.item.total_num)+"件商品，总金额 ¥"+t._s(t.item.total_price)+" ")]),e("div",{staticClass:"actions"},[10===t.item.order_status?e("div",[10===t.item.pay_status?e("span",{on:{click:function(e){return t.onPayOrder(t.item.order_id)}}},[t._v(" 立刻付款 ")]):10===t.item.delivery_status?e("span",{on:{click:function(e){return e.stopPropagation(),t.onCancelOrder(t.item.order_id)}}},[t._v(" 申请取消 ")]):20===t.item.delivery_status||30===t.item.delivery_status?e("span",{on:{click:function(e){return t.onReceiptOrder(t.item.order_id)}}},[t._v(" 确认收货 ")]):t._e()]):30===t.item.order_status?e("div",[e("span",[t._v("评价")])]):t._e()])])}),n=[],o=i(3387),d=i(4842),c={name:"OrderListItem",mixins:[d.A],methods:{async onCancelOrder(t){const e=await this.cancelOrderConfirm();e&&(await(0,o.Ti)(t),this.$emit("order-updated"))},async onReceiptOrder(t){await(0,o.hv)(t),this.$emit("order-updated")},async onPayOrder(t){await(0,o.T1)(t),this.$emit("order-updated")}},props:{item:{type:Object,default:()=>({})}}},l=c,u=i(1656),m=(0,u.A)(l,s,n,!1,null,"78f8b543",null),v=m.exports,p={name:"Orders",components:{OrderListItem:v},data(){return{active:this.$route.query.dataType||"all",page:1,list:[]}},methods:{async getOrderList(){const t=await(0,o.Pk)(this.active,this.page),e=t.data.list.data;e.forEach((t=>{t.total_num=t.goods.reduce(((t,e)=>t+e.total_num),0)})),this.list=e}},watch:{active:{immediate:!0,handler(){this.getOrderList()}}}},_=p,h=(0,u.A)(_,a,r,!1,null,"244892b8",null),f=h.exports},3387:function(t,e,i){i.d(e,{K2:function(){return d},Pk:function(){return r},T1:function(){return o},Ti:function(){return s},hv:function(){return n}});var a=i(5720);const r=(t,e)=>a.A.get("/order/list",{params:{dataType:t,page:e}}),s=t=>a.A.post("/order/cancel",{orderId:t}),n=t=>a.A.post("/order/receipt",{orderId:t}),o=t=>a.A.post("/order/pay",{orderId:t,payType:"10"}),d=t=>a.A.post("/order/detail",{orderId:t})},4842:function(t,e,i){i(3387);e.A={methods:{cancelOrderConfirm(){return this.$dialog.confirm({title:"友情提示",message:"确定要取消订单吗",confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>!0)).catch((()=>!1))}}}}}]);
//# sourceMappingURL=204.7cd254e5.js.map