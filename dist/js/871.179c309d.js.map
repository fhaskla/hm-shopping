{"version":3,"file":"js/871.179c309d.js","mappings":"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","sources":["webpack://hm-shopping/./src/components/BtnSearchInput.vue","webpack://hm-shopping/src/components/BtnSearchInput.vue","webpack://hm-shopping/./src/components/BtnSearchInput.vue?7daa","webpack://hm-shopping/./src/components/BtnSearchInput.vue?2be7","webpack://hm-shopping/./src/views/SearchList/SearchList.vue","webpack://hm-shopping/src/views/SearchList/SearchList.vue","webpack://hm-shopping/./src/views/SearchList/SearchList.vue?bea7","webpack://hm-shopping/./src/views/SearchList/SearchList.vue?c66c","webpack://hm-shopping/./src/api/product.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('van-search',{directives:[{name:\"focus\",rawName:\"v-focus\"}],attrs:{\"show-action\":\"\",\"placeholder\":_vm.placeholder,\"value\":_vm.value},on:{\"input\":_vm.handleInput},scopedSlots:_vm._u([{key:\"action\",fn:function(){return [_c('div',{on:{\"click\":function($event){return _vm.btnFun(..._vm.btnFunParams)}}},[_vm._v(\"搜索\")])]},proxy:true}])})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\r\nexport default {\r\n  name: \"BtnSearchInput\",\r\n  data() {\r\n    return {}\r\n  },\r\n  props: {\r\n    // 只读，不能修改，接收从父组件传递过来的value值\r\n    value: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    btnFun: {\r\n      type: Function,\r\n      required: true\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: \"请在此输入搜索关键词\"\r\n    },\r\n    btnFunParams: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n  },\r\n  methods: {\r\n    handleInput(van_search_value) {\r\n      // 触发自定义绑定在自己身上的input事件，并且把从van-search输入框收到的value值传递给父组件\r\n      this.$emit('input', van_search_value)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <!--传递父组件的value给van-search组件，并接收来自van_search组件的van_search_value给父组件-->\r\n  <!--这里不能使用v-model='value'，因为这相当于直接修改只读的value-->\r\n  <!--当van-search组件触发自定义input事件的时候，调用handleInput方法，handleInput方法再去触发SearchInput组件的自定义input事件-->\r\n  <!--把来自van-search组件的van_search_value传递给SearchInput组件的父组件，相当于实现了一次孙传父-->\r\n  <van-search\r\n      show-action\r\n      :placeholder=\"placeholder\"\r\n      :value=\"value\"\r\n      @input=\"handleInput\"\r\n      v-focus\r\n  >\r\n    <template #action>\r\n      <div @click=\"btnFun(...btnFunParams)\">搜索</div>\r\n    </template>\r\n  </van-search>\r\n</template>\r\n\r\n<style scoped lang=\"less\">\r\n// ::v-deep 贯穿 scoped 作用到子元素\r\n.van-search::v-deep .van-search__action {\r\n  background-color: #c21401;\r\n  color: #fff;\r\n  padding: 0 20px;\r\n  border-radius: 0 5px 5px 0;\r\n  margin-right: 10px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BtnSearchInput.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BtnSearchInput.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./BtnSearchInput.vue?vue&type=template&id=288b1bce&scoped=true\"\nimport script from \"./BtnSearchInput.vue?vue&type=script&lang=js\"\nexport * from \"./BtnSearchInput.vue?vue&type=script&lang=js\"\nimport style0 from \"./BtnSearchInput.vue?vue&type=style&index=0&id=288b1bce&prod&scoped=true&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"288b1bce\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search\"},[_c('van-nav-bar',{attrs:{\"fixed\":\"\",\"title\":\"商品列表\",\"left-arrow\":\"\",\"placeholder\":\"\"},on:{\"click-left\":function($event){return _vm.$router.go(-1)}}}),_c('BtnSearchInput',{attrs:{\"btn-fun\":_vm.searchBtnFun},model:{value:(_vm.searchInput),callback:function ($$v) {_vm.searchInput=$$v},expression:\"searchInput\"}}),_c('div',{staticClass:\"sort-btns\"},_vm._l((_vm.navList),function(item){return _c('div',{key:item,staticClass:\"sort-item\",class:{active:_vm.activeName === item},on:{\"click\":function($event){_vm.activeName = item}}},[_vm._v(\" \"+_vm._s(item)+\" \")])}),0),_c('div',{staticClass:\"goods-list\"},_vm._l((_vm.productList),function(item){return _c('GoodsItem',{key:item.goods_id,attrs:{\"item\":item}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\r\nimport GoodsItem from \"@/components/GoodsItem.vue\";\r\nimport {getProductListApi} from \"@/api/product\";\r\nimport BtnSearchInput from \"@/components/BtnSearchInput.vue\";\r\nimport {mapMutations} from \"vuex\";\r\n\r\nexport default {\r\n  name: \"SearchList\",\r\n  components: {BtnSearchInput, GoodsItem},\r\n  data() {\r\n    return {\r\n      // 输入框内容会修改，searchInput 是和 input 框双向绑定的，所以不用computed\r\n      searchInput: this.$route.query.search || '',\r\n      page: 1,\r\n      productList: [],\r\n      navList: ['综合', '销量', '价格'],\r\n      activeName: '综合',\r\n    }\r\n  },\r\n  computed: {\r\n    // 分类id不会修改，所以使用computed没有问题\r\n    categoryId() {\r\n      return this.$route.query.categoryId || ''\r\n    }\r\n  },\r\n  created() {\r\n    // 不管是从分类页还是搜索页，最终都是跳转到搜索列表页，直接在搜索列表页搜集历史记录就行\r\n    this.SET_HISTORY(this.searchInput) // 把 searchInput 内容存入历史记录\r\n  },\r\n  methods: {\r\n    ...mapMutations('user', ['REMOVE_HISTORY', 'SET_HISTORY']), // 清空历史记录 和 设置历史记录 的方法\r\n\r\n    // 返回一个选择哪种类型排序的对象\r\n    sort(type) {\r\n      // 使用一个对象来映射 type 到对应的排序对象\r\n      const sortOptions = {\r\n        '综合': {sortType: 'all'}, // 综合排序\r\n        '销量': {sortType: 'sales', sortPrice: 0}, // 销量从低到高排序\r\n        '价格': {sortType: 'price'} // 价格从低到高排序\r\n      };\r\n\r\n      // 返回对应的排序对象，如果没有匹配则返回一个空对象，其实就是要携带的请求参数\r\n      return sortOptions[type] || {};\r\n    },\r\n\r\n    // 根据不同排序类型请求获得商品列表\r\n    async getProductList(obj) {\r\n\r\n      const res = await getProductListApi({\r\n        // 这里如果searchInput和categoryId是空字符串，那会传递undefined，axios不会携带参数值为undefined的参数\r\n        goodsName: this.searchInput || undefined, // 商品名称\r\n        page: this.page, // 页数\r\n        categoryId: this.categoryId || undefined, // 分类id\r\n        ...obj\r\n      })\r\n\r\n      this.productList = res.data.list.data\r\n    },\r\n\r\n    // BtnSearchInput 组件的按钮方法\r\n    searchBtnFun() {\r\n      const obj = this.sort(this.activeName) // 获取排序对象\r\n      this.getProductList(obj) // 请求商品列表\r\n\r\n      // 点击按钮相当于在搜索列表页再次搜索\r\n      this.SET_HISTORY(this.searchInput) // 把 searchInput 内容存入历史记录\r\n    }\r\n  },\r\n  watch: {\r\n    activeName: {\r\n      immediate: true,\r\n      handler(newVal) {\r\n        const obj = this.sort(newVal)\r\n        this.getProductList(obj)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"search\">\r\n    <!--placeholder 固定在顶部时，在标签位置生成一个等高的占位元素-->\r\n    <van-nav-bar\r\n        fixed\r\n        title=\"商品列表\"\r\n        left-arrow\r\n        @click-left=\"$router.go(-1)\"\r\n        placeholder\r\n    />\r\n\r\n    <!--搜索框-->\r\n    <!-- btnFun 方法传入的参数是 btnFunParams ,是一个数组,而且 v-model 必传，这样才可以绑定数据和 input 框-->\r\n    <BtnSearchInput :btn-fun=\"searchBtnFun\" v-model=\"searchInput\"></BtnSearchInput>\r\n\r\n    <!-- 排序选项按钮 -->\r\n    <div class=\"sort-btns\">\r\n      <div\r\n          v-for=\"item in navList\"\r\n          :key=\"item\"\r\n          @click=\"activeName = item\"\r\n          class=\"sort-item\"\r\n          :class=\"{active:activeName === item}\"\r\n      >\r\n        {{ item }}\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"goods-list\">\r\n      <GoodsItem v-for=\"item in productList\" :key=\"item.goods_id\" :item=\"item\"></GoodsItem>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.search {\r\n\r\n  .sort-btns {\r\n    display: flex;\r\n    height: 36px;\r\n    line-height: 36px;\r\n\r\n    .sort-item {\r\n      text-align: center;\r\n      flex: 1;\r\n      font-size: 16px;\r\n    }\r\n\r\n    .active {\r\n      color: red;\r\n    }\r\n  }\r\n}\r\n\r\n.goods-list {\r\n  background-color: #f6f6f6;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchList.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SearchList.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./SearchList.vue?vue&type=template&id=5c42412c&scoped=true\"\nimport script from \"./SearchList.vue?vue&type=script&lang=js\"\nexport * from \"./SearchList.vue?vue&type=script&lang=js\"\nimport style0 from \"./SearchList.vue?vue&type=style&index=0&id=5c42412c&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5c42412c\",\n  null\n  \n)\n\nexport default component.exports","import axiosInstance from '@/utils/request'\r\n\r\nexport const getProductListApi = (obj) => {\r\n  const {sortType, sortPrice, categoryId, goodsName, page} = obj\r\n  return axiosInstance.get('/goods/list', {\r\n    // 某个值如果没传递为undefined或null，axios就不会携带这个参数\r\n    params: {\r\n      sortType, // 排序类型\r\n      sortPrice, // 0是价格从低到高，1是价格从高到低，前提是排序类型选择了价格排序\r\n      categoryId, // 分类id\r\n      goodsName, // 商品名称\r\n      page // 第几页\r\n    }\r\n  })\r\n}\r\n\r\nexport const getProductDetailApi = (goodsId) => {\r\n  return axiosInstance.get('/goods/detail', {\r\n    params: {\r\n      goodsId\r\n    }\r\n  })\r\n}\r\n\r\nexport const getProductCommentApi = (goodsId, limit) => {\r\n  return axiosInstance.get('/comment/listRows', {\r\n    params: {\r\n      goodsId, // 商品id\r\n      limit // 评论数量\r\n    }\r\n  })\r\n}\r\n"],"names":["render","_vm","this","_c","_self","directives","name","rawName","attrs","placeholder","value","on","handleInput","scopedSlots","_u","key","fn","$event","btnFun","btnFunParams","_v","proxy","staticRenderFns","data","props","type","String","required","Function","default","Array","methods","van_search_value","$emit","component","staticClass","$router","go","searchBtnFun","model","searchInput","callback","$$v","expression","_l","navList","item","class","active","activeName","_s","productList","goods_id","components","BtnSearchInput","GoodsItem","$route","query","search","page","computed","categoryId","created","SET_HISTORY","mapMutations","sort","sortOptions","sortType","sortPrice","getProductList","obj","res","getProductListApi","goodsName","undefined","list","watch","immediate","handler","newVal","axiosInstance","get","params","getProductDetailApi","goodsId","getProductCommentApi","limit"],"sourceRoot":""}