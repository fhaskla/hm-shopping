"use strict";(self["webpackChunkhm_shopping"]=self["webpackChunkhm_shopping"]||[]).push([[385],{385:function(t,s,a){a.r(s),a.d(s,{default:function(){return h}});a(4114);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"product"},[s("van-nav-bar",{attrs:{placeholder:"",fixed:"",title:"商品详情页","left-arrow":""},on:{"click-left":function(s){return t.$router.go(-1)}}}),s("van-swipe",{attrs:{autoplay:3e3},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[s("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+" / "+t._s(t.swipeImages.length))])]},proxy:!0}])},t._l(t.swipeImages,(function(t){return s("van-swipe-item",{key:t.file_id},[s("img",{attrs:{src:t.external_url,alt:""}})])})),1),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[s("div",{staticClass:"price"},[s("span",{staticClass:"now"},[t._v("￥"+t._s(t.productDetail.goods_price_min))]),s("span",{staticClass:"oldprice"},[t._v("￥"+t._s(t.productDetail.goods_price_max))])]),s("div",{staticClass:"sellcount"},[t._v("已售"+t._s(t.productDetail.goods_sales)+"件")])]),s("div",{staticClass:"msg text-ellipsis-2"},[t._v(" "+t._s(t.productDetail.goods_name)+" ")]),s("div",{staticClass:"service"},[s("div",{staticClass:"left-words"},[s("span",[s("van-icon",{attrs:{name:"passed"}}),t._v("七天无理由退货")],1),s("span",[s("van-icon",{attrs:{name:"passed"}}),t._v("48小时发货")],1)]),s("div",{staticClass:"right-icon"},[s("van-icon",{attrs:{name:"arrow"}})],1)])]),s("div",{staticClass:"comment"},[s("div",{staticClass:"comment-title"},[s("div",{staticClass:"left"},[t._v("商品评价 ("+t._s(t.productCommentTotal)+"条)")]),s("div",{staticClass:"right"},[t._v("查看更多 "),s("van-icon",{attrs:{name:"arrow"}})],1)]),s("div",{staticClass:"comment-list"},t._l(t.productComment,(function(a){return s("div",{key:a.comment_id,staticClass:"comment-item"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:a.user.avatar_url||t.defaultImg,alt:""}}),s("div",{staticClass:"name"},[t._v(t._s(a.user.nick_name))]),s("van-rate",{attrs:{"allow-half":"",size:16,value:a.score/2,color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1),s("div",{staticClass:"content"},[t._v(" "+t._s(a.content)+" ")]),s("div",{staticClass:"time"},[t._v(" "+t._s(a.create_time)+" ")])])})),0)]),s("div",{staticClass:"desc",domProps:{innerHTML:t._s(t.productDetail.content)}}),s("div",{staticClass:"footer"},[s("div",{staticClass:"icon-home",on:{click:function(s){return t.$router.push("/")}}},[s("van-icon",{attrs:{name:"wap-home-o"}}),s("span",[t._v("首页")])],1),s("div",{staticClass:"icon-cart",on:{click:function(s){return t.$router.push("/cart")}}},[t.cartTotal>0?s("span",{staticClass:"num"},[t._v(t._s(t.cartTotal))]):t._e(),s("van-icon",{attrs:{name:"shopping-cart-o"}}),s("span",[t._v("购物车")])],1),s("div",{staticClass:"btn-add",on:{click:function(s){return t.showPanel("加入购物车")}}},[t._v("加入购物车")]),s("div",{staticClass:"btn-buy",on:{click:function(s){return t.showPanel("立刻购买")}}},[t._v("立刻购买")])]),s("van-action-sheet",{attrs:{title:t.titlePanel},model:{value:t.isShowPanel,callback:function(s){t.isShowPanel=s},expression:"isShowPanel"}},[s("div",{staticClass:"panel"},[s("div",{staticClass:"title"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t.productDetail.goods_image,alt:""}})]),s("div",{staticClass:"right"},[s("div",{staticClass:"price"},[s("span",[t._v("¥")]),s("span",{staticClass:"nowprice"},[t._v(t._s(t.productDetail.goods_price_min))])]),s("div",{staticClass:"count"},[s("span",[t._v("库存")]),s("span",[t._v(t._s(t.productDetail.stock_total))])])])]),s("div",{staticClass:"num-box"},[s("span",[t._v("数量")]),s("CountBox",{model:{value:t.buyCount,callback:function(s){t.buyCount=s},expression:"buyCount"}})],1),t.productDetail.stock_total>0?s("div",{staticClass:"showbtn"},["加入购物车"===t.titlePanel?s("div",{staticClass:"btn",on:{click:t.onAddCart}},[t._v("加入购物车")]):"立刻购买"===t.titlePanel?s("div",{staticClass:"btn now",on:{click:t.onGoCheckout}},[t._v("立刻购买")]):t._e()]):s("div",{staticClass:"btn-none"},[t._v("该商品已抢完")])])])],1)},o=[],e=a(7867),n=a(7767),c=a(8974),r=a(9652),l=a(2272),d={methods:{loginConfirm(){return!this.$store.getters.token&&(this.$dialog.confirm({title:"温馨提示",message:"此时需要先登录才能继续操作哦",confirmButtonText:"去登录",cancelButtonText:"再逛逛"}).then((()=>{this.$router.replace({path:"/login",query:{fromUrl:this.$route.fullPath,toUrl:this.$route.fullPath}})})).catch((()=>{})),!0)}}},u={name:"Product",mixins:[d],components:{CountBox:c.A},data(){return{productId:this.$route.params.id,swipeImages:[],productDetail:{},current:0,productComment:[],productCommentTotal:0,defaultImg:n,isShowPanel:!1,titlePanel:"",buyCount:1,cartTotal:(0,l.Tj)()}},methods:{onChange(t){this.current=t},async getProductDetail(){const t=await(0,e.jL)(this.productId);this.swipeImages=t.data.detail.goods_images,this.productDetail=t.data.detail},async getProductComment(){const t=await(0,e.VQ)(this.productId,3);this.productComment=t.data.list,this.productCommentTotal=t.data.total},showPanel(t){this.titlePanel=t,this.isShowPanel=!0},async onAddCart(){if(this.loginConfirm())return;const t=this.productDetail.skuList[0].goods_sku_id,s=await(0,r.Yu)(this.productId,t,this.buyCount);this.cartTotal=s.data.cartTotal,(0,l.bH)(this.cartTotal),this.$toast("加入购物车成功"),this.isShowPanel=!1},onGoCheckout(){this.loginConfirm()||this.$router.push({path:"/checkout",query:{mode:"buyNow",goodsId:this.productId,goodsSkuId:this.productDetail.skuList[0].goods_sku_id,goodsNum:this.buyCount}})}},created(){this.getProductDetail(),this.getProductComment()}},p=u,m=a(1656),v=(0,m.A)(p,i,o,!1,null,"b1028d84",null),h=v.exports},7867:function(t,s,a){a.d(s,{Mc:function(){return o},VQ:function(){return n},jL:function(){return e}});var i=a(5720);const o=t=>{const{sortType:s,sortPrice:a,categoryId:o,goodsName:e,page:n}=t;return i.A.get("/goods/list",{params:{sortType:s,sortPrice:a,categoryId:o,goodsName:e,page:n}})},e=t=>i.A.get("/goods/detail",{params:{goodsId:t}}),n=(t,s)=>i.A.get("/comment/listRows",{params:{goodsId:t,limit:s}})}}]);
//# sourceMappingURL=385.23c2166e.js.map